
\begin{exercise}{1.15}
  By Exercise 1.1 (r),
  we show that $\inf_{\Gamma} U_\Gamma = \sup_{\Gamma} L_\Gamma = A$
  if and only if for each $\epsilon > 0$,
  there exists a partition $\Gamma$ such that $0 \le U_\Gamma - L_\Gamma < \epsilon$.

  ($\Longleftarrow$) We have
  \[
    0 \le \inf U_\Gamma - \sup L_\Gamma \le U_\Gamma - L_\Gamma < \epsilon
  \]
  for each $\epsilon > 0$.
  It follows immediately that $\inf U_\Gamma = \sup L_\Gamma$.

  ($\Longrightarrow$) For each $\epsilon > 0$,
  select a partition $\Gamma_1$ such that $U_{\Gamma_1} < A + \epsilon/2$
  and also a partition $\Gamma_2$ such that $L_{\Gamma_2} > A - \epsilon/2$.
  Let $\Gamma = \Gamma_1 \cup \Gamma_2$ be the common refinement of $\Gamma_1$ and $\Gamma_2$.
  It follows that
  \[
    0 \le U_{\Gamma} - L_{\Gamma} \le U_{\Gamma_1} - L_{\Gamma_2}
    < \left( A + \frac{\epsilon}{2} \right) - \left( A - \frac{\epsilon}{2} \right) = \epsilon.
    \qedhere
  \]
\end{exercise}

\begin{exercise}{1.20}
  For the first part, if $E_q = \left\{ q \right\}^C$, then
  \[
    \bbR - \bbQ = \bigcap_{q \in \bbQ} E_q
  \]
  is a $G_\delta$ set since each $E_q$ is open (and also dense).
  For the second part,
  suppose $\bbQ = \bigcap_n G_n$ is a $G_\delta$ set.
  Each $G_n$ is dense in $\bbR$ since $\bbQ \in G_n$ and $\bbQ$ is.
  It follows that
  \[
    \emptyset = \left( \bbR - \bbQ \right) \cap \bbQ
    = \left( \bigcap_{q \in \bbQ} E_q \right) \bigcap \left( \bigcap_n G_n \right)
  \]
  is a countable intersection of open dense subsets of $\bbR$,
  which is dense again by Exercise 1.19.
  But an empty set cannot be dense in $\bbR$.
\end{exercise}

\begin{exercise}{2.5}
  First observe that $f(x) \le |f(b)| + M$ for every $x \in (a, b]$.
  It follows that $L = \max \left\{ |f(b)| + M, f(a) \right\}$ is a bound of $f$.
  Suppose $\Gamma = \left\{ x_j \right\}_0^k$ is a partition of $[a, b]$.
  Then we have
  \[
    S_{\Gamma} = \left| f(x_1) - f(a) \right| +
    \sum_{j = 1}^{k-1} \left| f(x_{j+1}) - f(x_j) \right|
    \le 2L + V[f; x_1,b]
    \le 2L + M.
  \]
  Taking supremum we see that $V[f;a,b] \le 2L + M < +\infty$
  and $f$ is of bounded variation.

%  However, it does not necessarily follow that $V[f; a,b] \le M$.
  Assume further that $f$ is right-hand continuous at $a$.
  For each $\epsilon > 0$, there exists a $\xi$ such that
  $a < \xi < x_1$ and $|f(\xi) - f(a)| < \epsilon$.
  If $\Gamma'$ is the partition formed by inserting $\xi$ into $\Gamma$,
  we have
  \[
    S_\Gamma \le S_{\Gamma'} \le \left| f(\xi) - f(a) \right| + V[f; \xi, b]
    < \epsilon + M.
  \]
  Since $\epsilon$ is arbitrary, we have $S_{\Gamma} \le M$ for every $\Gamma$.
  Taking supremum, we obtain $V[f;a,b] \le M$.
\end{exercise}

\begin{exercise}{2.15}
  Let $\Gamma = \{x_j\}_0^k$ be a partition of $[a,b]$.
  Then
  \[
    S_\Gamma = \sum \left\vert \psi(x_j) - \psi(x_{j-1}) \right\vert
    = \sum \left\vert \int_{x_{j-1}}^{x_j} f \rmd \phi \right\vert
    \le \left(\sup |f|\right) \sum V[\phi; x_{j-1}, x_j]
    \le \left(\sup |f|\right) V[\phi; a,b],
  \]
  where the first inequality follows from Theorem 2.24.
  This holds for all $\Gamma$ and therefore $\psi$ is of bounded variation.
  If $g$ is continuous on $[a,b]$,
  both $\int_a^b g \rmd \psi$ and $\int_a^b fg \rmd \phi$ exist
  by Theorem 2.24.
  Consider the Riemann-Stieltjes sum for $g \rmd \psi$, we have
  \begin{align*}
    & \sum g(\xi_j) \left( \psi(x_j) - \psi(x_{j-1}) \right) \\
    = & \sum g(\xi_j) f(\eta_j) \left( \phi(x_j) - \phi(x_{j-1}) \right) \\
    = & \sum g(\xi_j) f(\xi_j) \left( \phi(x_j) - \phi(x_{j-1}) \right)
    + \sum g(\xi_j) \left( f(\eta_j) - f(\xi_j) \right)
    \left( \phi(x_j) - \phi(x_{j-1}) \right) \\
    = & I_1 + I_2,
  \end{align*}
  where the first equality follows from Theorem 2.27 (Mean-Value Theorem)
  with each $\eta_j \in [x_{j-1}, x_j]$.
  The term $I_1$ is the Riemann-Stieltjes sum for $gf \rmd \phi$
  and tends to $\int_a^b fg \rmd \phi$ as $|\Gamma| \rightarrow 0$.
  Using the uniform continuity of $f$ on $[a,b]$,
  we can select $|\Gamma|$ so small that
  \[
    \left\vert f(\eta_j) - f(\xi_j) \right\vert <
    \frac{\epsilon} {\left( \sup g \right) V[\phi; a,b]}
  \]
  for every $0 \le j < k$.
  It follows that $|I_2| < \epsilon$
  and consequently $\lim_{|\Gamma| \rightarrow 0} I_2 = 0$.
  The proof of $\int_a^b g \rmd \psi = \int_a^b fg \rmd \phi$ is thus completed.
\end{exercise}

\begin{exercise}{2.20}
  Clearly $S \coloneqq \lim_{|\Gamma| \rightarrow 0} S_\Gamma[f;a,b] \le V[f;a,b]$
  if the limit exists.
  To show the reverse inequality,
  first select a partition $\Gamma'$ such that
  $S_{\Gamma'} > V[f;a,b] - \epsilon/2$.
  Then select a $\delta > 0$ such that
  $|S_\Gamma - S| < \epsilon/2$ whenever $|\Gamma| < \delta$.
  Let $\Gamma^\ast$ be the refinement of $\Gamma'$
  subject to $|\Gamma^\ast| < \delta$.
  Then we have $S_{\Gamma'} \le S_{\Gamma^\ast}$, and
  \[
    V[f;a,b] - S < V - S_{\Gamma^\ast} + \epsilon/2
    \le V - S_{\Gamma'} + \epsilon/2
    < \epsilon/2 + \epsilon/2 = \epsilon.
  \]
  Since $\epsilon > 0$ is arbitrary,
  we have $V[f;a,b] \le S$.
\end{exercise}

\begin{exercise}{3.1}
  Suppose $b > 1$ is an integer and $0 \le x < 1$.
  We determine the integral sequence $c_k$ as follows.
  Let $c_1 = \lfloor bx \rfloor$, i.e.\
  the greatest integer less than or equal to $bx$.
  Then $0 \le c_1 < b$ and $0 \le bx - c_1 < 1$.
  Having determined $c_1, \cdots, c_{k-1}$,
  we determine $c_k$ by choosing
  \[
    c_k = \lfloor b^k x - \sum_{j=1}^{k-1} c_j b^{k-j} \rfloor.
  \]
  Since by the induction hypothesis $0 \le b^{k-1} x - \sum_1^{k-1} c_j b^{k-1-j} < 1$,
  we have $0 \le c_k < b$ and also
  \begin{equation}
    0 \le b^k x - \sum_1^{k} c_j b^{k-j} < 1.
    \label{eq:base_b_sandwich}
  \end{equation}
  This completes the induction step and
  hence the determination of the sequence $c_k$.
  Dividing by $b^{-k}$ in~\eqref{eq:base_b_sandwich}
  and letting $k \rightarrow \infty$,
  we obtain $x = \sum_1^{\infty} c_j b^{-j}$.
  In the exceptional case of $x = 1$,
  we shall choose $c_j = b-1$ for all $j \ge 1$.

  Suppose $\{c_j\}$ and $\{d_j\}$ are integral sequence
  such that $0 \le c_j, d_j < b$ and
  $\sum_{1}^{\infty} (c_j - d_j) b^{-j} = 0$.
  Let $k$ be the smallest index such that $c_k \neq d_k$.
  If no such $k$ exists, then $\{c_j\}$ are $\{d_j\}$ are identical sequences.
  Otherwise, we have
  \[
    b^{-k} \le \left| \left( c_k - d_k \right) b^{-k} \right|
    = \left| \sum_{j=k+1}^{\infty} \left( d_j - c_j \right) b^{-j} \right|
    \le \sum_{j=k+1}^{\infty} (b-1) b^{-j}
    = b^{-k}
  \]
  since $c_k \neq d_k$ and $|d_j - c_j| \le b-1$ for all $j \ge k+1$.
  It follows that the inequalities are in fact equalities,
  and this is the case if and only if
  $c_k - d_k = 1$ and $d_j - c_j = b-1 \Leftrightarrow d_j = b-1, c_j = 0$
  for all $j \ge k+1$ (or vice versa).
  It also follows that
  \[
    x = \sum_{j=1}^k c_j b^{-j} = c b^{-k},
  \]
  where $1 \le c = \sum_1^k c_j b^{k-j} \le b^k-1$.
\end{exercise}

\begin{exercise}{3.9}
  For each $\epsilon > 0$,
  select $n \in \bbZ^+$ so large that $\sum_n^{\infty} \outmea{E_k} < \epsilon$.
  Then $\limsup E_k \subset \cup_{k=n}^{\infty} E_k$,
  and by countable subadditivity we have
  \[
    \outmea{\limsup E_k} \le \outmea{ \cup_{k=n}^{\infty} E_k}
    \le \sum_{k=n}^{\infty} \outmea{E_k} < \epsilon.
  \]
  Since $\epsilon$ is arbitrary,
  we see that $\limsup E_k$ has measure zero,
  and so does $\liminf E_k$ since it is a subset of the former.
\end{exercise}
